document.addEventListener("DOMContentLoaded", function (event) { document.querySelector('#navmainpage').style.display = "none"; var navMenu = document.querySelector('#navmainpage'); document.querySelector('#search-help').style.display = "none"; var searchToggle = document.querySelector('#search-toggle'); searchToggle.addEventListener('click', searchHelpToggler); var menuButton = document.querySelector('.hiddenmenu'); menuButton.addEventListener('click', menuToggle); var helpButton = document.querySelector('button#help'); helpButton.addEventListener('click', helpMenuToggler); var persButton = document.querySelector('button#pers'); persButton.addEventListener('click', persButtonToggler); var addButton = document.querySelector('button#add'); addButton.addEventListener('click', addButtonToggler); var placeButton = document.querySelector('button#places'); placeButton.addEventListener('click', placeButtonToggler); var pencilButton = document.querySelector('button#pencils'); pencilButton.addEventListener('click', pencilButtonToggler); var gapsButton = document.querySelector('button#gaps'); gapsButton.addEventListener('click', gapsButtonToggler); var notesButton = document.querySelector('button#notes'); notesButton.addEventListener('click', notesButtonToggler); const theGaps = document.querySelectorAll('span[type="gap"]'); var currentPageName = ""; var currentPageNameCount = 0; function menuToggle() { let currentState = document.querySelector('#navmainpage').style.display; if (currentState === "none") { navMenu.style.display = "block" } else { navMenu.style.display = "none" } if (currentPageNameCount === 0) { let url = window.location.pathname; let currentPosition = document.querySelector('#navmainpage').querySelector('a[href=".' + url + '"]'); currentPageName = currentPosition.innerHTML; currentPosition.innerHTML = "<span class='navarrow'>â†’ </span>" + currentPosition.innerHTML; currentPageNameCount = 1 } } function sanitize(string) { return string.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") } function putPageTitle() { let pageTitle = sanitize(document.title); let target = document.getElementById('title_location'); target.textContent = pageTitle } function helpMenuToggler() { let theHelpBox = document.querySelector('div#helpbox'); let theHelpBoxStyle = document.querySelector('div#helpbox').style.display; if (theHelpBoxStyle != "block") { theHelpBox.style.display = "block" } else { theHelpBox.style.display = "none" } theHelpBox.classList.toggle('helpactive'); helpButton.classList.toggle('red') } function persButtonToggler() { var persons = document.getElementsByTagName('persname'); if (persons.length === 0) { persButton.classList.toggle('no-matches') } else { persButton.classList.toggle('red'); for (var i = 0; i < persons.length; i += 1) { persons[i].classList.toggle('active'); persons[i].parentElement.closest('td').classList.toggle('personHighlight') } } } function addButtonToggler() { var adds = document.querySelectorAll('add:not([rend="pencil"])'); if (adds.length === 0) { addButton.classList.toggle('no-matches') } else { addButton.classList.toggle('red'); for (var i = 0; i < adds.length; i += 1) { adds[i].classList.toggle('active'); adds[i].parentElement.closest('td').classList.toggle('addHighlight') } } } function placeButtonToggler() { var places = document.getElementsByTagName("placename"); if (places.length === 0) { placeButton.classList.toggle('no-matches') } else { placeButton.classList.toggle('red'); for (var i = 0; i < places.length; i += 1) { places[i].classList.toggle('active'); places[i].parentElement.closest('td').classList.toggle('redHighlight') } } } function pencilButtonToggler() { var pencils = document.querySelectorAll("add[rend='pencil']"); if (pencils.length === 0) { pencilButton.classList.toggle('no-matches') } else { pencilButton.classList.toggle('red'); for (var i = 0; i < pencils.length; i += 1) { pencils[i].classList.toggle('active'); pencils[i].parentElement.closest('td').classList.toggle('pencilHighlight') } } } function gapsButtonToggler() { gapsButton.classList.toggle('red'); var gaps = document.querySelectorAll('span[type="gap"]'); for (var i = 0; i < gaps.length; i += 1) { gaps[i].classList.toggle('hidden') } } function notesButtonToggler() { allNotes = document.querySelectorAll('note'); if (allNotes.length === 0) { notesButton.classList.toggle('no-matches') } else { notesButton.classList.toggle('red'); for (var i = 0; i < allNotes.length; i += 1) { allNotes[i].classList.toggle('hidden'); allNotes[i].classList.toggle('active') } } } function searchHelpToggler() { let searchHelpStyle = document.querySelector('#search-help').style.display; let searchHelp = document.querySelector('#search-help'); if (searchHelpStyle != "block") { searchHelp.style.display = "block"; searchToggle.textContent = "hide help" } else { searchHelp.style.display = "none"; searchToggle.textContent = "show help" } } window.addEventListener('scroll', function () { var header = document.querySelector('#search-menu'); header.classList.toggle("sticky", window.scrollY > 0); if (this.window.scrollY > 100) { navMenu.style.display = "none" } }); fetch("./resources/html_snippets/navigation-menu.html").then(data => { return data.text() }).then(data => { document.querySelector("#navmainpage").innerHTML = data }); fetch("./resources/html_snippets/helpmenu.html").then(data => { return data.text() }).then(data => { document.querySelector("#helpbox").innerHTML = data }); fetch("./resources/html_snippets/colophon.html").then(data => { return data.text() }).then(data => { document.querySelector("#righty").innerHTML = data }); theLB = document.querySelectorAll('lb'); for (var i = 0; i < theLB.length; i += 1) { let new_node = document.createElement('br'); theLB[i].parentNode.insertBefore(new_node, theLB[i].nextSibling) } theUnclear = document.getElementsByTagName('unclear'); for (var i = 0; i < theUnclear.length; i += 1) { let new_node = document.createElement('span'); theUnclear[i].parentNode.insertBefore(new_node, theUnclear[i].nextSibling); theUnclear[i].textContent = " " + theUnclear[i].textContent + " " } function mindTheGaps() { for (var i = 0; i < theGaps.length; i += 1) { theGaps[i].classList.remove('hidden') } } var people = document.querySelectorAll('persname'); for (var i = 0; i < people.length; i += 1) { let title = people[i].getAttribute('ref'); if (title != 'undefined') { if (typeof people[i] != 'undefined') { if (title != null) { people[i].setAttribute('title', title); people[i].classList.add('person-title') } } } } var places = document.querySelectorAll('placename'); for (var i = 0; i < places.length; i += 1) { let title = places[i].getAttribute('ref'); if (title != 'undefined') { if (typeof places[i] != 'undefined') { if (title != null) { places[i].setAttribute('title', title); places[i].classList.add('place-title') } } } } var thePlaceNotes = document.querySelectorAll('note:not([type="editorial"])'); for (var i = 0; i < thePlaceNotes.length; i += 1) { let place = thePlaceNotes[i].getAttribute('place'); let content = thePlaceNotes[i].textContent; let result = ''; if (place != null) { result += "Location: " + sanitize(place) + " |" } if (content != null) { result += " Content: " + sanitize(content) + "  " } let str1 = '<span type="note" style="border-bottom:1px dotted; "title="'; let str2 = '" ><span>[note]</span>'; let placeNote = str1.concat(result, str2); thePlaceNotes[i].innerHTML = placeNote; thePlaceNotes[i].classList.add("hidden") } var theEdNotes = document.querySelectorAll('note[type="editorial"]'); for (var i = 0; i < theEdNotes.length; i += 1) { let ednote = theEdNotes[i].textContent; let result = ''; if (ednote != null) { result += "Note: " + sanitize(ednote) + " " } let str1 = '<span type="note" style="border-bottom:1px dotted; "title="'; let str2 = '" ><span>[note]</span>'; let theEdNote = str1.concat(result, str2); theEdNotes[i].innerHTML = theEdNote; theEdNotes[i].classList.add("hidden") } putPageTitle(); mindTheGaps() });